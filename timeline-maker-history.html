<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simple Timeline Maker</title>
    <style>
      :root {
        --primary-color: #4a6fa5;
        --secondary-color: #6b8cae;
        --accent-color: #ff7e5f;
        --light-color: #f8f9fa;
        --dark-color: #343a40;
        --timeline-color: #4a6fa5;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background-color: var(--light-color);
        color: var(--dark-color);
        line-height: 1.6;
        padding: 20px;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
      }

      h1 {
        text-align: center;
        margin-bottom: 30px;
        color: var(--primary-color);
      }

      .input-section {
        background-color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        margin-bottom: 30px;
      }

      .form-group {
        margin-bottom: 15px;
      }

      label {
        display: block;
        margin-bottom: 5px;
        font-weight: 600;
        color: var(--primary-color);
      }

      input,
      textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 16px;
      }

      textarea {
        min-height: 80px;
        resize: vertical;
      }

      button {
        background-color: var(--primary-color);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        transition: background-color 0.3s;
        margin-right: 10px;
        margin-bottom: 10px;
      }

      button:hover {
        background-color: var(--secondary-color);
      }

      .btn-danger {
        background-color: #dc3545;
      }

      .btn-danger:hover {
        background-color: #c82333;
      }

      .btn-success {
        background-color: #28a745;
      }

      .btn-success:hover {
        background-color: #218838;
      }

      .timeline-container {
        position: relative;
        padding: 20px 0;
        background-color: white;
      }

      .timeline {
        position: relative;
        max-width: 800px;
        margin: 0 auto;
      }

      .timeline::after {
        content: "";
        position: absolute;
        width: 4px;
        background-color: var(--timeline-color);
        top: 0;
        bottom: 0;
        left: 50%;
        margin-left: -2px;
        border-radius: 2px;
      }

      .timeline-item {
        padding: 10px 40px;
        position: relative;
        width: 50%;
        opacity: 1;
        background-color: white;
        animation: fadeIn 0.5s forwards;
      }

      @keyframes fadeIn {
        to {
          opacity: 1;
        }
      }

      .timeline-item::after {
        content: "";
        position: absolute;
        width: 20px;
        height: 20px;
        background-color: white;
        border: 4px solid var(--accent-color);
        border-radius: 50%;
        top: 15px;
        z-index: 1;
      }

      .left {
        left: 0;
      }

      .right {
        left: 50%;
      }

      .left::after {
        right: -12px;
      }

      .right::after {
        left: -12px;
      }

      .timeline-content {
        padding: 20px;
        background-color: white !important;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        position: relative;
        color: black !important;
        opacity: 1 !important;
        will-change: transform;
        border: 1px solid #333; /* <-- Add this line */
      }

      .timeline-year {
        font-weight: bold;
        color: var(--accent-color);
        margin-bottom: 5px;
        font-size: 18px;
      }

      .timeline-description {
        color: var(--dark-color);
      }

      .delete-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        background: none;
        border: none;
        color: #dc3545;
        cursor: pointer;
        font-size: 16px;
        padding: 5px;
      }

      .empty-state {
        text-align: center;
        padding: 40px;
        color: #6c757d;
      }

      .button-group {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 15px;
      }

      @media screen and (max-width: 768px) {
        .timeline::after {
          left: 31px;
        }

        .timeline-item {
          width: 100%;
          padding-left: 70px;
          padding-right: 25px;
        }

        .timeline-item::after {
          left: 21px;
        }

        .left::after,
        .right::after {
          left: 21px;
        }

        .right {
          left: 0;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Simple Timeline Maker</h1>

      <div class="input-section">
        <div class="form-group">
          <label for="year">Year</label>
          <input
            type="number"
            id="year"
            placeholder="Enter year (e.g., 2023)"
          />
        </div>
        <div class="form-group">
          <label for="description">Description</label>
          <textarea
            id="description"
            placeholder="Enter event description"
          ></textarea>
        </div>
        <div class="button-group">
          <button id="add-btn">Add to Timeline</button>
          <button id="clear-btn" class="btn-danger">Clear All</button>
          <button id="save-btn" class="btn-success">Save as PNG</button>
        </div>
      </div>

      <div class="timeline-container" id="timeline-container">
        <div class="timeline" id="timeline"></div>
      </div>
    </div>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const yearInput = document.getElementById("year");
        const descriptionInput = document.getElementById("description");
        const addBtn = document.getElementById("add-btn");
        const clearBtn = document.getElementById("clear-btn");
        const saveBtn = document.getElementById("save-btn");
        const timeline = document.getElementById("timeline");
        const timelineContainer = document.getElementById("timeline-container");

        let events = JSON.parse(localStorage.getItem("timelineEvents")) || [];

        renderTimeline();

        addBtn.addEventListener("click", function () {
          const year = yearInput.value.trim();
          const description = descriptionInput.value.trim();

          if (!year || !description) {
            alert("Please enter both year and description");
            return;
          }

          events.push({ year: parseInt(year), description });
          saveEvents();
          renderTimeline();

          yearInput.value = "";
          descriptionInput.value = "";
          yearInput.focus();
        });

        clearBtn.addEventListener("click", function () {
          if (confirm("Are you sure you want to clear all events?")) {
            events = [];
            saveEvents();
            renderTimeline();
          }
        });

        saveBtn.addEventListener("click", function () {
          const originalText = saveBtn.textContent;
          saveBtn.textContent = "Generating...";
          saveBtn.disabled = true;

          const deleteButtons = document.querySelectorAll(".delete-btn");
          deleteButtons.forEach((btn) => (btn.style.display = "none"));

          // Force opaque styling
          timelineContainer.style.backgroundColor = "#ffffff";
          timelineContainer.style.opacity = "1";

          document.querySelectorAll(".timeline-content").forEach((el) => {
            el.style.backgroundColor = "#ffffff";
            el.style.opacity = "1";
            el.style.color = "#000000";
          });

          html2canvas(timelineContainer, {
            scale: 2,
            backgroundColor: "#ffffff",
            logging: false,
            useCORS: true,
            allowTaint: true,
            letterRendering: true,
          })
            .then((canvas) => {
              const link = document.createElement("a");
              const timestamp = new Date().toISOString().replace(/[:.]/g, "-");
              link.download = `timeline-${timestamp}.png`;
              link.href = canvas.toDataURL("image/png", 1.0);
              link.click();

              deleteButtons.forEach((btn) => (btn.style.display = "block"));
              saveBtn.textContent = originalText;
              saveBtn.disabled = false;
            })
            .catch((err) => {
              console.error("Error generating image:", err);
              alert("Error generating image. Please try again.");
              deleteButtons.forEach((btn) => (btn.style.display = "block"));
              saveBtn.textContent = originalText;
              saveBtn.disabled = false;
            });
        });

        function renderTimeline() {
          timeline.innerHTML = "";

          if (events.length === 0) {
            timeline.innerHTML =
              '<div class="empty-state">No events yet. Add some events to see them on the timeline!</div>';
            return;
          }

          events.sort((a, b) => a.year - b.year);

          events.forEach((event, index) => {
            const timelineItem = document.createElement("div");
            timelineItem.className = `timeline-item ${
              index % 2 === 0 ? "left" : "right"
            }`;

            timelineItem.innerHTML = `
              <div class="timeline-content">
                <button class="delete-btn" data-index="${index}">Ã—</button>
                <div class="timeline-year">${event.year}</div>
                <div class="timeline-description">${event.description}</div>
              </div>
            `;

            timeline.appendChild(timelineItem);

            timelineItem
              .querySelector(".delete-btn")
              .addEventListener("click", function () {
                const indexToDelete = parseInt(this.getAttribute("data-index"));
                events.splice(indexToDelete, 1);
                saveEvents();
                renderTimeline();
              });
          });
        }

        function saveEvents() {
          localStorage.setItem("timelineEvents", JSON.stringify(events));
        }
      });
    </script>
  </body>
</html>
